<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Formulaire √©tude de raccordement</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/compressorjs@1.2.1/dist/compressor.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
	<script src="https://unpkg.com/lucide@latest"></script>
	<!-- debug mobile
	  <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
	  <script>eruda.init();</script>
	-->
	<script src="editor.js"></script>
	<script src="template.js" defer></script>
	<script src="script.js" defer></script>
  </head>
  <body>
    <header>
      <h1>Etude de raccordement</h1>
    </header>
    <main>
      <form id="raccordementForm">
	<hr>
	<h3>Informations client</h3>
	<label for="nomCli">Nom</label>
	<input type="text" id="nomCli" oninput="this.value = this.value.toUpperCase()" maxlength="64" required />
	<label for="prenomCli">Pr√©nom</label>
	<input type="text" id="prenomCli" maxlenght="64" required />
	<label for="adresseCli">Adresse</label>
	<input type="text" id="adresseCli" maxlenght="64" required />
	<label for="cpCli">Code postal</label>
	<input type="integer" id="cpCli" maxlenght="5" required />
	<label for="villeCli">Ville</label>
        <input type="text" id="villeCli" oninput="this.value = this.value.toUpperCase()" required />
	<label for="complementAdrCli">Compl√©ment d'adresse</label>
	<textarea id="complementAdrCli" rows="3"></textarea>
	<label for="noDossier">Num√©ro de dossier OSR</label>
	<input type="integer" id="noDossier" maxlenght="64" oninput="this.value = this.value.toUpperCase()" required />
<hr />
<h3>Donn√©es sur le r√©seau</h3>
        <label for="noDipole">Num√©ro dipole</label>
	<input type="integer" id="noDipole" />
	<label for="distAmont">Distance en amont du dip√¥le</label>
	<input type="integer" id="distAmont" />
    <label>Point GPS du dip√¥le</label>
<div style="display: flex; gap: 5px; align-items: center;">
    <input type="text" id="gps-lat" placeholder="Latitude" readonly style="flex: 1;" />
    <input type="text" id="gps-lon" placeholder="Longitude" readonly style="flex: 1;" />
    <button type="button" onclick="getLocation()" title="Obtenir ma position" style="width: 44px;">üìç</button>
</div>    
<p style="font-size: 0.8rem; color: #555; margin-bottom: 15px;">
    Relev√© au pied de l'ouvrage pour la pr√©cision carto.
</p>
<label for="nomDepartBT">Nom du d√©part BT</label>
    <input type="text" id="nomDepartBT" />
    <label for="codeGDODepartBT">Code GDO d√©part BT</label>
    <input type="integer" id="codeGDODepartBT" />
    <label for="nomPosteHTABT">Nom du poste HTA/BT</label>
    <input type="text" id="nomPosteHTABT" />
    <label for="codeGDOPosteHTABT">Code GDO du poste HTA/BT</label>
    <input type="integer" id="codeGDOPosteHTABT" required />
<hr />
<h3>Raccordement</h3>
<label for="techBranchement">Technique de branchement</label>
<select id="techBranchement" onchange="this.style.width = (this.options[this.selectedIndex].text.length + 3) + 'ch'" required>
  <option value="" disabled selected >Selectionnez une technique de branchement</option>
  <option value="Branchement complet a√©rien">Branchement complet a√©rien</option>
  <option value="Branchement complet a√©ro-souterrain">Branchement complet a√©ro-souterrain</option>
  <option value="Branchement complet souterrain">Branchement complet souterrain</option>
  <option value="Liaison privative">Liaison privative</option>
  <option value="Liaison publique souterraine">Liaison publique souterraine</option>
  <option value="Liaison publique a√©ro-souterraine">Liaison publique a√©ro-souterraine</option>
</select>
<label class="req-group">Type de branchement</label>
<div class="radio-group">
    <!-- si un input radio es obligatoire, tous ceux du m√™me nom le deviennent -->
    <div class="radio-item">
        <input type="radio" id="T1" name="typeBranchement" value="Type 1" required>
        <label for="T1">Type 1</label>
    </div>
    <div class="radio-item">
        <input type="radio" id="T2" name="typeBranchement" value="Type 2">
        <label for="T2">Type 2</label>
    </div>
</div>
<label for="longDomainePublic">Longueur en domaine public</label>
<div style="display: flex; align-items: center; gap: 5px;">
    <input type="text" id="longDomainePublic" required style="width: 90%; margin: 0;">
    <span>m</span>
</div>
<label for="longDomainePrive">Longueur en domaine priv√©</label>
<div style="display: flex; align-items: center; gap: 5px;">
    <input type="text" id="longDomainePrive" required style="width: 90%; margin: 0;">
    <span>m</span>
</div>
<label class="req-group">Tranch√©e et fourreau fournis par le demandeur</label>
<div class="radio-group">
    <div class="radio-item">
        <input type="radio" id="oui" name="trancheeEtFourreau" value="Oui" required>
        <label for="oui">Oui</label>
    </div>
    <div class="radio-item">
        <input type="radio" id="non" name="trancheeEtFourreau" value="Non">
        <label for="non">Non</label>
    </div>
    <div class="radio-item">
	    <input type="radio" id="derivation" name="trancheeEtFourreau" value="D√©rivation individuelle r√©alis√©e par le client">
	    <label for="derivation">D√©rivation individuelle r√©alis√©e par le client</label>
    </div>
</div>
<h3>Chiffrage</h3>
<label for="domaineIntervention">Domaine d'intervention</label>
<select id="domaineIntervention" onchange="this.style.width = (this.options[this.selectedIndex].text.length + 3) + 'ch'" required >
  <option value="" disabled selected >S√©lectionnez un domaine d'intervention</option>
  <option value="D√©rivation individuelle + Liaison r√©seau" >D√©rivation individuelle + Liaison r√©seau</option>
  <option value="D√©rivation individuelle" >D√©rivation individuelle</option>
  <option value="Liaison r√©seau" >Liaison r√©seau</option>
</select>
<label for="IRVE">IRVE</label>
<select id='IRVE'>
  <option value="Sans IRVE">Sans IRVE</option>
  <option value="IRVE">IRVE</option>
</select>
<label class="req-group">Sch√©ma directeur IRVE valid√©</label>
<div class="radio-group">
    <div class="radio-item">
        <input type="radio" id="ouiIRVE" name="schemaIRVE" value="Oui">
        <label for="ouiIRVE">Oui</label>
    </div>
    <div class="radio-item">
        <input type="radio" id="nonIRVE" name="schemaIRVE" value="Non">
        <label for="nonIRVE">Non</label>
    </div>
</div>
<label class="req-group">Nombre de phases en consommation</label>
<div class="radio-group">
    <div class="radio-item">
        <input type="radio" id="monophase" name="nbPhasesConso" value="Monophas√©" checked onchange="updatePuissance()">
        <label for="monophase">Monophas√©</label>
    </div>
    <div class="radio-item">
        <input type="radio" id="triphase" name="nbPhasesConso" value="Triphas√©" onchange="updatePuissance()">
        <label for="triphase">Triphas√©</label>
    </div>
</div>

<label class="req-group">Puissance de raccordement max</label>
<select id="puissanceRaccordement" required>
    </select>

<label class="req-group">Puissance souscrite souhait√©e</label>
<select id="puissanceSouscrite" required>
    </select>
<h3>D√©tails des travaux</h3>
<label>Local d'habitation de plus de 2 ans</label>
<div class="radio-group">
    <div class="radio-item">
        <input type="radio" id="ouiLocal" name="localHabitation" value="Oui">
        <label for="ouiLocal">Oui</label>
    </div>
    <div class="radio-item">
        <input type="radio" id="nonLocal" name="localHabitation" value="Non">
        <label for="nonLocal">Non</label>
    </div>
</div>
<label>Travaux √† la charge du demandeur</label>
<div class="radio-group">
    <div class="radio-item">
        <input type="radio" id="ouiDemandeur" name="travauxChargeDemandeur" onchange="toggleTravaux()" value="Oui">
        <label for="ouiDemandeur">Oui</label>
    </div>
    <div class="radio-item">
        <input type="radio" id="nonDemandeur" name="travauxChargeDemandeur" onchange="toggleTravaux()" value="Non">
        <label for="nonDemandeur">Non</label>
    </div>
</div>
<div id="sectionTravaux" style="display: none;">
    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
        <div style="flex: 1; min-width: 200px;">
            <label for="datePrevue">Fin des travaux pr√©vue le :</label>
            <input type="date" id="datePrevue" style="width: 100%;">
        </div>
        <div style="flex: 1; min-width: 200px;">
            <label for="dateReelle">Fin des travaux r√©elle le :</label>
            <input type="date" id="dateReelle" style="width: 100%;">
        </div>
    </div>
    <label>Travaux √† la charge du demandeur</label>
<div class="checkbox-list">
	<label class="checkbox-item"><input type="checkbox" name="listeTravaux" value=""> R√©alisation d'une tranch√©e</label><hr />
	<label class="checkbox-item"><input type="checkbox" name="listeTravaux" value=""> Pose de fourreau</label><hr />
	<label class="checkbox-item"><input type="checkbox" name="listeTravaux" value=""> Reprise de l'installation existante</label><hr />
	<label class="checkbox-item"><input type="checkbox" name="listeTravaux" value=""> R√©alisation d'une saign√©e dans le mur</label><hr />
	<label class="checkbox-item"><input type="checkbox" name="listeTravaux" value=""> Confection d'une niche dans un mur</label><hr />
	<label class="checkbox-item"><input type="checkbox" name="listeTravaux" value=""> R√©alisation d'un cr√©pi pour une surface plane √† l'emplacement du panneau de comptage</label><hr />
	<label class="checkbox-item"><input type="checkbox" name="listeTravaux" value=""> Mat√©rialisation de l'emplacement de la borne dans la cl√¥ture</label><hr />
	<label class="checkbox-item"><input type="checkbox" name="listeTravaux" value=""> D√©gagement de l'emplacement du tableau de comptage</label><hr />
	<label class="checkbox-item"><input type="checkbox" name="listeTravaux" value=""> Encastrement du coffret ext√©rieur de comptage</label><hr />
	<label class="checkbox-item"><input type="checkbox" name="listeTravaux" value=""> Pose du socle support ou borne au sol</label><hr />
    <label class="checkbox-item"><input type="checkbox" name="listeTravaux" value=""> Fourniture pose d'une protection m√©canique compl√©mentaire pour le coffret ext√©rieur</label>
</div>
    <label for="commTravaux">Commentaires sur les travaux :</label>
    <textarea id="commTravaux" rows="3"></textarea>
</div><hr />
        <h2>Gestion des photos</h2>
        <input type="file" id="photos" accept="image/*" multiple>
        <button type="button" id="take-photo">üì∑ Prendre une photo</button>
        <video id="camera" autoplay style="display:none; width:300px;"></video>
        <canvas id="camera-canvas" style="display:none;"></canvas>
	<div style="text-align: center; margin-top: 10px;">
            <button type="button" id="save-photo" style="display: none;" class="capture-button">
	         <i class="fas fa-camera"></i>
	    </button>
	</div>
        <h3>Aper√ßu des photos</h3>
        <div id="photo-preview"></div>

	<hr />
	<!--
	<h3>Etude du branchement √©lectrique</h3>
	<label for="energieUtil">Energie utilis√©e</label>
        <select id="energieUtil" onchange="this.style.width = (this.options[this.selectedIndex].text.length + 3) + 'ch'" required>
            <option value="" disabled selected>S√©lectionnez un type d'√©nergie</option>
            <option value="conso">consomation</option>
            <option value="prod">production</option>
        </select>
        <hr />
	-->
        <h3>Signature de l'agent EDF</h3>
	<canvas id="signature-representant-canvas" ></canvas>
	<button type="button" id="clear-representant" class="remove-sign" >Effacer</button>
	<hr />
<button type="submit" id="generatePDF">G√©n√©rer le PDF</button>
      </form>
    </main>
  </body>
</html>
